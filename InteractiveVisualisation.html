<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <style>
    body{
        font-family: Helvetica, sans-serif;
    }

    .reveal-if-active{
        opacity: 0;
        max-height: 0;
        overflow: hidden;
        transition: 0.5s;
    }

    input[type="radio"]:checked ~ .reveal-if-active {
        opacity: 1;
        max-height: 100px;
        padding: 10px 20px;
        overflow: visible;

    }
    </style>
</head>

<body>
<h1>Number of SAT Test-takers and SAT Scores by Demographic</h1>
<!-- subject buttons -->
<form id = "subjects">
    <input type="radio" name="subject" value="Test-takers" id = "test_takers" onclick="createTestTakers()">Test-takers</input>
    <input type="radio" name="subject" value="Math" id = "math_scores" onclick="createMath()">Math</input>
    <input type="radio" name="subject" value="Verbal" id = "verbal_scores" onclick="createVerbal()">Verbal</input>
</form>

<div style="text-align: center;">	
    <svg width = "1200" height = "500"></svg>	
</div>

<form>
    <div>
        <input type="radio" name="category" value="income" id = "default" onclick="createIncome(bottomButtonCheck())" checked>Income Bracket</input>
        <div class="reveal-if-active">
            <input type="checkbox" id='Less than 20k' onclick="createIncome(bottomButtonCheck())" checked>Below 20k</input>	
            <input type="checkbox" id='Between 20-40k' onclick="createIncome(bottomButtonCheck())" checked>20k - 40k</input>	
            <input type="checkbox" id='Between 40-60k' onclick="createIncome(bottomButtonCheck())" checked>40k - 60k</input>	
            <input type="checkbox" id='Between 60-80k' onclick="createIncome(bottomButtonCheck())" checked>60k - 80k</input>	
            <input type="checkbox" id='Between 80-100k' onclick="createIncome(bottomButtonCheck())" checked>80k - 100k</input>	
            <input type="checkbox" id='More than 100k' onclick="createIncome(bottomButtonCheck())" checked>Above 100k</input>
        </div> 
    </div>
    
    <div>
        <input type="radio" name="category" value="score_range" onclick="createScoreRange(bottomButtonCheck())">Score Range</input>
        <div class="reveal-if-active"> 
            <input type="checkbox" id='Between 200 to 300' onclick="createScoreRange(bottomButtonCheck())" checked>200-300</input>	
            <input type="checkbox" id='Between 300 to 400' onclick="createScoreRange(bottomButtonCheck())" checked>300-400</input>	
            <input type="checkbox" id='Between 400 to 500' onclick="createScoreRange(bottomButtonCheck())" checked>400-500</input>	
            <input type="checkbox" id='Between 500 to 600' onclick="createScoreRange(bottomButtonCheck())" checked>500-600</input>	
            <input type="checkbox" id='Between 600 to 700' onclick="createScoreRange(bottomButtonCheck())" checked>600-700</input>	
            <input type="checkbox" id='Between 700 to 800' onclick="createScoreRange(bottomButtonCheck())" checked>700-800</input>
        </div> 
    </div>

    <div>	
        <input type="radio" name="category" value="gender" onclick="createGender(bottomButtonCheck())">Gender</input>	
        <div class="reveal-if-active">	
            <input type="checkbox" id='Female' onclick="createGender(bottomButtonCheck())" checked>Female</input>	
            <input type="checkbox" id='Male' onclick="createGender(bottomButtonCheck())" checked>Male</input> 	
        </div>	
    </div>
    
    <div>	
        <input type="radio" name="category" value="gpa" onclick="createGPA(bottomButtonCheck())">GPA</input>	
        <div class="reveal-if-active">	
            <input type="checkbox" id='A plus' onclick="createGPA(bottomButtonCheck())" checked>A+</input>	
            <input type="checkbox" id='A' onclick="createGPA(bottomButtonCheck())" checked>A</input>	
            <input type="checkbox" id='A minus' onclick="createGPA(bottomButtonCheck())" checked>A-</input>	
            <input type="checkbox" id='B' onclick="createGPA(bottomButtonCheck())" checked>B</input>	
            <input type="checkbox" id='C' onclick="createGPA(bottomButtonCheck())" checked>C</input>	
            <input type="checkbox" id='D or lower' onclick="createGPA(bottomButtonCheck())" checked>D or lower</input> 	
        </div>	
    </div> 

</form>
</body>

<script src="http://d3js.org/d3.v6.min.js"></script>

<script>
    var years = ["2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015"];
    var colors = ["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"];

    function createTestTakers(){
        document.getElementById("default").checked = true;
        createIncome("test_takers");
    }

    function createMath(){
        document.getElementById("default").checked = true;
        createIncome("math_scores");
    }

    function createVerbal(){
        document.getElementById("default").checked = true;
        createIncome("verbal_scores");
    }

    function bottomButtonCheck(){
        var takers = document.getElementById("test_takers").checked;
        var math = document.getElementById("math_scores").checked;
        var verbal = document.getElementById("verbal_scores").checked;

        if (takers){
            var value = "test_takers";
        } else if (math) {
            var value = "math_scores";
        } else if (verbal) {
            var value = "verbal_scores";
        }
        
        return value;
    }

    function filterIncomeColumns(columns, value){	
        var lower20 = document.getElementById('Less than 20k').checked;	
        var b20to40 = document.getElementById('Between 20-40k').checked;	
        var b40to60 = document.getElementById('Between 40-60k').checked;	
        var b60to80 = document.getElementById('Between 60-80k').checked;	
        var b80to100 = document.getElementById('Between 80-100k').checked;	
        var plus100 = document.getElementById('More than 100k').checked;	
        var arr = [false, b20to40, b40to60, b60to80, b80to100, lower20, plus100];	
        const results = columns.filter((d, ind) => arr[ind]);	
        return results;	
    }	
    function filterScoreRange(columns, value){	
        var s200to300 = document.getElementById('Between 200 to 300').checked;	
        var s300to400 = document.getElementById('Between 300 to 400').checked;	
        var s400to500 = document.getElementById('Between 400 to 500').checked;	
        var s500to600 = document.getElementById('Between 500 to 600').checked;	
        var s600to700 = document.getElementById('Between 600 to 700').checked;	
        var s700to800 = document.getElementById('Between 700 to 800').checked;	
        var arr = [s200to300, s300to400, s400to500, s500to600, s600to700, s700to800];	
<<<<<<< HEAD
=======
        console.log(arr);	
>>>>>>> 354696f28a85928b70452f94b69ef64b17eec37f
        const results = columns.filter((d, ind) => arr[ind]);	
        return results;	
    }	
    function filterGenderColumns(columns, value){	
        var female = document.getElementById("Female").checked;	
        var male = document.getElementById("Male").checked;	
        var arr = [false, female, male];	
        const results = columns.filter((d, ind) => arr[ind]);	
        return results;	
    }	
    function filterGPAColumns(columns, value){	
        var aPlus = document.getElementById("A plus").checked;	
        var a = document.getElementById("A").checked;	
        var aMinus = document.getElementById("A minus").checked;	
        var b = document.getElementById("B").checked;	
        var c = document.getElementById("C").checked;	
        var d = document.getElementById("D or lower").checked;	
        var arr = [false, aMinus, aPlus, a, b, c, d];	
        const results = columns.filter((d, ind) => arr[ind]);	
        return results;	
    }

    function createIncome(value){
        d3.selectAll("svg > *").remove();
        var file = "data/income_" + value + ".csv";
        
        d3.csv(file).then(function (data) {
            var columns = data.columns.filter(i => i != 'Year');
            var myColor = d3.scaleOrdinal().domain(columns)
                .range(["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"]);

            //do scales
            var svg = d3.select("svg");
            var margin = 200;
            var width = svg.attr("width") - margin;
            var height = svg.attr("height") - margin;

            //make scales
            var xScale = d3.scaleBand().range([0, width]).padding(0.4),
            yScale = d3.scaleLinear().range([height, 0]);

            //idk why but yeh
            var g = svg.append("g")
                    .attr("transform", "translate(" + 100 + "," + 50 + ")")
                    .attr("class", value);

            if (value === "test_takers"){
                var max = d3.max(data, function (d) {
                    return Math.max(d['Family Income.Less than 20k.Test-takers'], d['Family Income.Between 20-40k.Test-takers'], d['Family Income.Between 40-60k.Test-Takers'],
                        d['Family Income.Between 60-80k.Test-takers'], d['Family Income.Between 80-100k.Test-takers'], d['Family Income.More than 100k.Test-takers'])
                });
                    
                var min = d3.min(data, function (d) {
                    return Math.min(d['Family Income.Less than 20k.Test-takers'], d['Family Income.Between 20-40k.Test-takers'], d['Family Income.Between 40-60k.Test-Takers'],
                        d['Family Income.Between 60-80k.Test-takers'], d['Family Income.Between 80-100k.Test-takers'], d['Family Income.More than 100k.Test-takers'])
                });
                
                var label = "Total Number of Test Takers";

            } else if (value === "math_scores"){
                var max = d3.max(data, function (d) {
                    return Math.max(d['Family Income.Less than 20k.Math'], d['Family Income.Between 20-40k.Math'], d['Family Income.Between 40-60k.Math'],
                        d['Family Income.Between 60-80k.Math'], d['Family Income.Between 80-100k.Math'], d['Family Income.More than 100k.Math'])
                });
                    
                var min = d3.min(data, function (d) {
                    return Math.min(d['Family Income.Less than 20k.Math'], d['Family Income.Between 20-40k.Math'], d['Family Income.Between 40-60k.Math'],
                        d['Family Income.Between 60-80k.Math'], d['Family Income.Between 80-100k.Math'], d['Family Income.More than 100k.Math'])
                }); 
                
                var label = "Median Math Score";
            } else if (value === "verbal_scores"){
                var max = d3.max(data, function (d) {
                    return Math.max(d['Family Income.Less than 20k.Verbal'], d['Family Income.Between 20-40k.Verbal'], d['Family Income.Between 40-60k.Verbal'],
                        d['Family Income.Between 60-80k.Verbal'], d['Family Income.Between 80-100k.Verbal'], d['Family Income.More than 100k.Verbal'])
                });
                    
                var min = d3.min(data, function (d) {
                    return Math.min(d['Family Income.Less than 20k.Verbal'], d['Family Income.Between 20-40k.Verbal'], d['Family Income.Between 40-60k.Verbal'],
                        d['Family Income.Between 60-80k.Verbal'], d['Family Income.Between 80-100k.Verbal'], d['Family Income.More than 100k.Verbal'])
                }); 
                
                var label = "Median Verbal Score";
            } else {
                console.log("Something has gone wrong.");
            }


            //create axes
            xScale.domain(years);
            yScale.domain([min, max]); 
            
            //x axis
            g.append("g")
            .attr("transform", "translate(0," + height + ")")
            .call(d3.axisBottom(xScale))
            .append("text")
            .attr("y", height - 250)
            .attr("x", width - 100)
            .attr("text-anchor", "center")
            .attr("fill", "black")
            .style("font-size", "12px")
            .text("Year");

            //y axis
            g.append("g")
            .call(d3.axisLeft(yScale))
            .append("text")
            .attr("transform", "rotate(-90)")
            .attr("y", 0)
            .attr("dy", "-5.1em")
            .attr("text-anchor", "center")
            .attr("fill", "black")
            .style("font-size", "12px")
            .text(label); 

            columns = filterIncomeColumns(columns, value);

            var g = d3.select("g");
            columns.forEach(i => {
                g.append("path")
                    .datum(data)
                    .attr("d", d3.line()
                        .x(function(d) { return xScale(d.Year) })
                        .y(function(d) { return yScale(d[i]) }))
                    .attr("fill", "none")
                    .attr("class", "line")
                    .attr("data-legend", i)
                    .attr("stroke", function(d) { return myColor(i) })
                    .attr("stroke-width", 1.5);

             // Add one dot in the legend for each name.
             svg.selectAll("mydots")
            .data(columns)
            .enter()
            .append("circle")
                .attr("cx", 980)
                .attr("cy", function(d,i){ return 25 + i*15}) // 100 is where the first dot appears. 25 is the distance between dots
                .attr("r", 5)
                .style("fill", function(d){ return myColor(d)});

            // Add one dot in the legend for each name.
            svg.selectAll("mylabels")
            .data(columns)
            .enter()
            .append("text")
                .attr("x", 1000)
                .attr("y", function(d,i){ return 25 + i*15 }) // 100 is where the first dot appears. 25 is the distance between dots
                .style("fill", function(d){ return myColor(d) })
                .text(function(d){ return d })
                .attr("text-anchor", "left")
                .style("font-size", "10px")
                .style("alignment-baseline", "middle");
            });

            
        })
    }
    function createScoreRange(value){

        d3.selectAll("svg > *").remove();
        var file = "data/score_range_" + value + ".csv";
        console.log(file)
        
        d3.csv(file).then(function (data) {
            var columns = data.columns.filter(i => i != 'Year');
            var myColor = d3.scaleOrdinal().domain(columns)	
                .range(["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"]);	
            console.log(columns);
            
            //do scales
            var svg = d3.select("svg");
            var margin = 200;
            var width = svg.attr("width") - margin;
            var height = svg.attr("height") - margin;

            //make scales
            var xScale = d3.scaleBand().range([0, width]).padding(0.4),
            yScale = d3.scaleLinear().range([height, 0]);

            //idk why but yeh
            var g = svg.append("g")
                    .attr("transform", "translate(" + 100 + "," + 50 + ")")
                    .attr("class", value);

            if (value === "test_takers"){
                var max = d3.max(data, function (d) {

                    var checkMax = Math.max(d['Score Ranges.Between 200 to 300.Total'], d['Score Ranges.Between 300 to 400.Total'], d['Score Ranges.Between 400 to 500.Total'], 
                     d['Score Ranges.Between 500 to 600.Total'], d['Score Ranges.Between 600 to 700.Total'], d['Score Ranges.Between 700 to 800.Total'])

                    console.log(checkMax)

                    return Math.max(d['Score Ranges.Between 200 to 300.Total'], d['Score Ranges.Between 300 to 400.Total'], d['Score Ranges.Between 400 to 500.Total'], 
                     d['Score Ranges.Between 500 to 600.Total'], d['Score Ranges.Between 600 to 700.Total'], d['Score Ranges.Between 700 to 800.Total'])
                });
                    
                var min = d3.min(data, function (d) {

                    var checkMin = Math.min(d['Score Ranges.Between 200 to 300.Total'], d['Score Ranges.Between 300 to 400.Total'], d['Score Ranges.Between 400 to 500.Total'], 
                     d['Score Ranges.Between 500 to 600.Total'], d['Score Ranges.Between 600 to 700.Total'], d['Score Ranges.Between 700 to 800.Total'])

                    console.log(checkMin)

                    return Math.min(d['Score Ranges.Between 200 to 300.Total'], d['Score Ranges.Between 300 to 400.Total'], d['Score Ranges.Between 400 to 500.Total'], 
                     d['Score Ranges.Between 500 to 600.Total'], d['Score Ranges.Between 600 to 700.Total'], d['Score Ranges.Between 700 to 800.Total'])
                });  
                
                var label = "Total Number of Test Takers";

            } else if (value === "math_scores"){
                var max = d3.max(data, function (d) {
                    return Math.max(d['Score Ranges.Between 200 to 300.Math.Total'], d['Score Ranges.Between 300 to 400.Math.Total'], d['Score Ranges.Between 400 to 500.Math.Total'], 
                     d['Score Ranges.Between 500 to 600.Math.Total'], d['Score Ranges.Between 600 to 700.Math.Total'], d['Score Ranges.Between 700 to 800.Math.Total'])
                });
                    
                var min = d3.min(data, function (d) {
                    return Math.min(d['Score Ranges.Between 200 to 300.Math.Total'], d['Score Ranges.Between 300 to 400.Math.Total'], d['Score Ranges.Between 400 to 500.Math.Total'], 
                     d['Score Ranges.Between 500 to 600.Math.Total'], d['Score Ranges.Between 600 to 700.Math.Total'], d['Score Ranges.Between 700 to 800.Math.Total'])
                });  

                var label = "Median Math Score";

            } else if (value === "verbal_scores"){
                var max = d3.max(data, function (d) {
                    return Math.max(d['Score Ranges.Between 200 to 300.Verbal.Total'], d['Score Ranges.Between 300 to 400.Verbal.Total'], d['Score Ranges.Between 400 to 500.Verbal.Total'], 
                     d['Score Ranges.Between 500 to 600.Verbal.Total'], d['Score Ranges.Between 600 to 700.Verbal.Total'], d['Score Ranges.Between 700 to 800.Verbal.Total'])
                });
                    
                var min = d3.min(data, function (d) {
                    return Math.min(d['Score Ranges.Between 200 to 300.Verbal.Total'], d['Score Ranges.Between 300 to 400.Verbal.Total'], d['Score Ranges.Between 400 to 500.Verbal.Total'], 
                     d['Score Ranges.Between 500 to 600.Verbal.Total'], d['Score Ranges.Between 600 to 700.Verbal.Total'], d['Score Ranges.Between 700 to 800.Verbal.Total'])
                });  

                var label = "Median Verbal Score";

            } else {
                console.log("Something went wrong.");
            }

            //create axes
            xScale.domain(years);
            yScale.domain([min, max]); 
            
            //x axis	
            g.append("g")	
            .attr("transform", "translate(0," + height + ")")	
            .call(d3.axisBottom(xScale))	
            .append("text")	
            .attr("y", height - 250)	
            .attr("x", width - 100)	
            .attr("text-anchor", "center")
            .attr("fill", "black")	
            .style("font-size", "12px")
            .text("Year");	
            //y axis	
            g.append("g")	
            .call(d3.axisLeft(yScale))	
            .append("text")	
            .attr("transform", "rotate(-90)")	
            .attr("y", 0)	
            .attr("dy", "-5.1em")	
            .attr("text-anchor", "center")	
            .attr("fill", "black")	
            .style("font-size", "12px")
            .text(label); 	
            ///filter goes here///	
            columns = filterScoreRange(columns, value);	
            var g = d3.select("g");	
            columns.forEach(i => {	
                g.append("path")	
                    .datum(data)	
                    .attr("d", d3.line()	
                        .x(function(d) { return xScale(d.Year) })	
                        .y(function(d) { return yScale(d[i]) }))	
                    .attr("fill", "none")	
                    .attr("class", "line")	
                    .attr("stroke", myColor(i))	
                    .attr("stroke-width", 1.5);

            // Add one dot in the legend for each name.
            svg.selectAll("mydots")
            .data(columns)
            .enter()
            .append("circle")
                .attr("cx", 950)
                .attr("cy", function(d,i){ return 50 + i*15}) // 100 is where the first dot appears. 25 is the distance between dots
                .attr("r", 5)
                .style("fill", function(d){ return myColor(d)});

            // Add one dot in the legend for each name.
            svg.selectAll("mylabels")
            .data(columns)
            .enter()
            .append("text")
                .attr("x", 970)
                .attr("y", function(d,i){ return 50 + i*15 }) // 100 is where the first dot appears. 25 is the distance between dots
                .style("fill", function(d){ return myColor(d) })
                .text(function(d){ return d })
                .attr("text-anchor", "left")
                .style("font-size", "10px")
                .style("alignment-baseline", "middle");
            });
        })     
    }

    function createGender(value){	
        d3.selectAll("svg > *").remove();	
        var file = "data/gender_" + value + ".csv";	
        console.log(file)	
        	
        d3.csv(file).then(function (data) {	
            var columns = data.columns.filter(i => i != 'Year');	
            var myColor = d3.scaleOrdinal().domain(columns)	
                .range(["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"]);	
            console.log(columns);	
            	
            //do scales	
            var svg = d3.select("svg");	
            var margin = 200;	
            var width = svg.attr("width") - margin;	
            var height = svg.attr("height") - margin;	
            //make scales	
            var xScale = d3.scaleBand().range([0, width]).padding(0.4),	
            yScale = d3.scaleLinear().range([height, 0]);	
            //idk why but yeh	
            var g = svg.append("g")	
                    .attr("transform", "translate(" + 100 + "," + 50 + ")")	
                    .attr("class", value);	
            if (value === "test_takers"){	
                var max = d3.max(data, function (d) {	
                    return Math.max(d['Gender.Female.Test-takers'], d['Gender.Male.Test-takers'])	
                });	
                    	
                var min = d3.min(data, function (d) {	
                    return Math.min(d['Gender.Female.Test-takers'], d['Gender.Male.Test-takers'])	
                });
                
                var label = "Total Number of Test Takers";
            } else if (value === "math_scores"){	
                var max = d3.max(data, function (d) {	
                    return Math.max(d['Gender.Female.Math'], d['Gender.Male.Math'], d['Total.Math'])	
                });	
                    	
                var min = d3.min(data, function (d) {	
                    return Math.min(d['Gender.Female.Math'], d['Gender.Male.Math'], d['Total.Math'])	
                });    	

                var label = "Median Math Score";
            } else if (value === "verbal_scores"){	
                var max = d3.max(data, function (d) {	
                    return Math.max(d['Gender.Female.Verbal'], d['Gender.Male.Verbal'], d['Total.Verbal'])	
                });	
                    	
                var min = d3.min(data, function (d) {	
                    return Math.min(d['Gender.Female.Verbal'], d['Gender.Male.Verbal'], d['Total.Verbal'])	
                });  
                
                var label = "Median Verbal Score";
            } else {	
                console.log("Something went wrong.");	
            }	
            //create axes	
            xScale.domain(years);	
            yScale.domain([min, max]); 	
            	
            //x axis	
            g.append("g")	
            .attr("transform", "translate(0," + height + ")")	
            .call(d3.axisBottom(xScale))	
            .append("text")	
            .attr("y", height - 250)	
            .attr("x", width - 100)	
            .attr("text-anchor", "center")	
            .attr("fill", "black")
            .style("font-size", "12px")	
            .text("Year");	
            //y axis	
            g.append("g")	
            .call(d3.axisLeft(yScale))	
            .append("text")	
            .attr("transform", "rotate(-90)")	
            .attr("y", 0)	
            .attr("dy", "-5.1em")	
            .attr("text-anchor", "center")	
            .attr("fill", "black")	
            .style("font-size", "12px")
            .text(label); 	
            ///filter goes here///	
            columns = filterGenderColumns(columns, value);	
            var g = d3.select("g");	
            columns.forEach(i => {	
                g.append("path")	
                    .datum(data)	
                    .attr("d", d3.line()	
                        .x(function(d) { return xScale(d.Year) })	
                        .y(function(d) { return yScale(d[i]) }))	
                    .attr("fill", "none")	
                    .attr("class", "line")	
                    .attr("stroke", myColor(i))	
                    .attr("stroke-width", 1.5);
                    
            // Add one dot in the legend for each name.
            svg.selectAll("mydots")
            .data(columns)
            .enter()
            .append("circle")
                .attr("cx", 1050)
                .attr("cy", function(d,i){ return 50 + i*15}) // 100 is where the first dot appears. 25 is the distance between dots
                .attr("r", 5)
                .style("fill", function(d){ return myColor(d)});

            // Add one dot in the legend for each name.
            svg.selectAll("mylabels")
            .data(columns)
            .enter()
            .append("text")
                .attr("x", 1070)
                .attr("y", function(d,i){ return 50 + i*15 }) // 100 is where the first dot appears. 25 is the distance between dots
                .style("fill", function(d){ return myColor(d) })
                .text(function(d){ return d })
                .attr("text-anchor", "left")
                .style("font-size", "10px")
                .style("alignment-baseline", "middle");
            });	
        })	
    }

    function createGPA(value){	
        d3.selectAll("svg > *").remove();	
        var file = "data/gpa_" + value + ".csv";	
        console.log(file)	
        d3.csv(file).then(function (data) {	
            var columns = data.columns.filter(i => i != 'Year');	
            console.log(columns);	
            var myColor = d3.scaleOrdinal().domain(columns)	
                .range(["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"]);	
            	
            //do scales	
            var svg = d3.select("svg");	
            var margin = 200;	
            var width = svg.attr("width") - margin;	
            var height = svg.attr("height") - margin;	
            //make scales	
            var xScale = d3.scaleBand().range([0, width]).padding(0.4),	
            yScale = d3.scaleLinear().range([height, 0]);	
            //idk why but yeh	
            var g = svg.append("g")	
                    .attr("transform", "translate(" + 100 + "," + 50 + ")")	
                    .attr("class", value);	
            if (value === "test_takers"){	
                var max = d3.max(data, function (d) {	
                    return Math.max(d['GPA.A plus.Test-takers'], d['GPA.A.Test-takers'], d['GPA.A minus.Test-takers'],	
                        d['GPA.B.Test-takers'], d['GPA.C.Test-takers'], d['GPA.D or lower.Test-takers'])	
                });	
                    	
                var min = d3.min(data, function (d) {	
                    return Math.min(d['GPA.A plus.Test-takers'], d['GPA.A.Test-takers'], d['GPA.A minus.Test-takers'],	
                        d['GPA.B.Test-takers'], d['GPA.C.Test-takers'], d['GPA.D or lower.Test-takers'])	
                }); 
                var label = "Total Number of Test Takers";    	
            } else if (value === "math_scores"){	
                var max = d3.max(data, function (d) {	
                    return Math.max(d['GPA.A plus.Math'], d['GPA.A.Math'], d['GPA.A minus.Math'],	
                        d['GPA.B.Math'], d['GPA.C.Math'], d['GPA.D or lower.Math'])	
                });	
                    	
                var min = d3.min(data, function (d) {	
                    return Math.min(d['GPA.A plus.Math'], d['GPA.A.Math'], d['GPA.A minus.Math'],	
                        d['GPA.B.Math'], d['GPA.C.Math'], d['GPA.D or lower.Math'])	
                });    
                
                var label = "Median Math Score";
            } else if (value === "verbal_scores"){	
                var max = d3.max(data, function (d) {	
                    return Math.max(d['GPA.A plus.Verbal'], d['GPA.A.Verbal'], d['GPA.A minus.Verbal'],	
                        d['GPA.B.Verbal'], d['GPA.C.Verbal'], d['GPA.D or lower.Verbal'])	
                });	
                    	
                var min = d3.min(data, function (d) {	
                    return Math.min(d['GPA.A plus.Verbal'], d['GPA.A.Verbal'], d['GPA.A minus.Verbal'],	
                        d['GPA.B.Verbal'], d['GPA.C.Verbal'], d['GPA.D or lower.Verbal'])	
                });   
                
                var label = "Median Verbal Score";
            } else {	
                console.log("Something went wrong.");	
            }	
            //create axes	
            xScale.domain(years);	
            yScale.domain([min, max]); 	
            	
            //x axis	
            g.append("g")	
            .attr("transform", "translate(0," + height + ")")	
            .call(d3.axisBottom(xScale))	
            .append("text")	
            .attr("y", height - 250)	
            .attr("x", width - 100)	
            .attr("text-anchor", "center")	
            .attr("fill", "black")	
            .style("font-size", "12px")
            .text("Year");	
            //y axis	
            g.append("g")	
            .call(d3.axisLeft(yScale))	
            .append("text")	
            .attr("transform", "rotate(-90)")	
            .attr("y", 0)	
            .attr("dy", "-5.1em")	
            .attr("text-anchor", "center")	
            .attr("fill", "black")	
            .style("font-size", "12px")
            .text(label); 	
            /// filter goes here ///	
            columns = filterGPAColumns(columns, value);	
            var g = d3.select("g");	
            columns.forEach(i => {	
                g.append("path")	
                    .datum(data)	
                    .attr("d", d3.line()	
                        .x(function(d) { return xScale(d.Year) })	
                        .y(function(d) { return yScale(d[i]) }))	
                    .attr("fill", "none")	
                    .attr("class", "line")	
                    .attr("stroke", myColor(i))	
                    .attr("stroke-width", 1.5);  
                    
            // Add one dot in the legend for each name.
            var legend = svg.append("svg");
            legend.style("background-color", "white");
            legend.selectAll("mydots")
            .data(columns)
            .enter()
            .append("circle")
                .attr("cx", 1050)
                .attr("cy", function(d,i){ return 40 + i*15}) // 100 is where the first dot appears. 25 is the distance between dots
                .attr("r", 5)
                .style("fill", function(d){ return myColor(d)});

            // Add one dot in the legend for each name.
            legend.selectAll("mylabels")
            .data(columns)
            .enter()
            .append("text")
                .attr("x", 1070)
                .attr("y", function(d,i){ return 40 + i*15 }) // 100 is where the first dot appears. 25 is the distance between dots
                .style("fill", function(d){ return myColor(d) })
                .text(function(d){ return d })
                .attr("text-anchor", "left")
                .style("font-size", "10px")
                .style("alignment-baseline", "middle");
            });	
        })	
}	
</script>	
</html>   